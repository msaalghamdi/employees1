<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>توليد ملف Excel</title>
</head>
<body>
  <h2>إدخال المعايير</h2>
  <label>الاسم: <input id="name" type="text"></label><br><br>
  <label>التاريخ: <input id="date" type="date"></label><br><br>
  <label>الدرجة: <input id="grade" type="number"></label><br><br>
  <button onclick="generateExcel()">توليد وتنزيل Excel</button>

  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/xlsx.full.min.js"></script>
  <script>
    function generateExcel() {
      // 1. قراءة المدخلات
      const name = document.getElementById('name').value || 'غير معروف';
      const date = document.getElementById('date').value || new Date().toISOString().split('T')[0];
      const grade = document.getElementById('grade').value || 0;

      // 2. إنشاء ورقة بيانات
      const ws = XLSX.utils.aoa_to_sheet([
        ['الاسم', 'التاريخ', 'الدرجة'],
        [name, date, grade]
      ]);

      // 3. كتابة الملف
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "التقرير");

      // 4. تنزيل
      XLSX.writeFile(wb, "التقرير.xlsx");
    }
  </script>
</body>
</html>
