<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>تعبئة نموذج التوطين الوهمي</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
body{font-family:Tahoma;background:#f5f5f5;padding:20px}
.container{background:#fff;padding:25px;border-radius:10px;max-width:900px;margin:auto}
input,select,textarea,button{width:100%;padding:10px;margin-top:8px}
button{background:#2e7d32;color:#fff;border:none;font-weight:bold;cursor:pointer}
</style>
</head>
<body>

<div class="container">
<h2>نموذج تعبئة تقرير التوطين الوهمي</h2>

<input id="templateFile" type="file" accept=".xlsx">
<input id="empName" placeholder="اسم العامل">
<input id="empId" placeholder="رقم الهوية">
<input id="crNum" placeholder="رقم السجل التجاري">
<input id="hrsdNum" placeholder="رقم المنشأة">
<select id="recommendation">
<option>صحة علاقة العمل</option>
<option>عدم صحة علاقة العمل</option>
</select>
<textarea id="notes" placeholder="ملاحظات"></textarea>

<button onclick="exportExcel()">تعبئة النموذج الرسمي</button>
</div>

<script>
const criteria = [
{ id:1, text:"عدم وجود عقد عمل موثق", weight:10 },
{ id:2, text:"عدم وجود تأمين طبي", weight:20 },
{ id:3, text:"إقرار بعدم وجود علاقة عمل", weight:80 }
];

function exportExcel() {
const file = document.getElementById("templateFile").files[0];
if(!file){ alert("أرفق ملف النموذج الرسمي"); return; }

const reader = new FileReader();
reader.onload = e => {
const wb = XLSX.read(new Uint8Array(e.target.result), {type:"array"});
const ws = wb.Sheets[wb.SheetNames[0]];

// بيانات عامة (عدّل الخلايا حسب ملفك)
ws["B4"].v = empName.value;
ws["E4"].v = empId.value;
ws["B5"].v = crNum.value;
ws["E5"].v = hrsdNum.value;
ws["B6"].v = recommendation.value;
ws["B7"].v = notes.value;

// جدول المؤشرات (يبدأ من الصف 12 كمثال)
let row = 12;
criteria.forEach(c => {
ws["A"+row] = {v:c.id};
ws["B"+row] = {v:c.text};
ws["C"+row] = {v:c.weight+"%"};
ws["D"+row] = {v:"نعم"};
row++;
});

XLSX.writeFile(wb,"جدول-المؤشرات-و الاوزان.xlsx");
};
reader.readAsArrayBuffer(file);
}
</script>

</body>
</html>
